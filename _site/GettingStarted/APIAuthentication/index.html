<h1 id="table-of-contents">Table of contents</h1>
<ul>
  <li><a href="#authentication">Authentication</a></li>
  <li><a href="#examples">Examples</a>
    <ul>
      <li><a href="#command-line">Command Line</a></li>
      <li><a href="#python">Python</a></li>
      <li><a href="#postman">Postman</a></li>
    </ul>
  </li>
</ul>

<h2 id="authentication">Authentication</h2>

<p>EarthPlatform STAC API is protected by bearer authentication.
A bearer token must be generated using <a href="https://www.oauth.com/oauth2-servers/access-tokens/client-credentials/">OAuth Client Credentials Flow</a>. The required client_id, client_secret and access_token_url values can be found on <a href="https://console.earthdaily.com/account">Account Management</a> page. These API credentials are specific to your user account on EarthPlatform and should be kept confidential.</p>

<p><img src="/Images/STACAPI/AccountInformation.png" alt="Client Credentials" /></p>

<h3 id="point-to-note">Point to Note</h3>

<ul>
  <li>The generated access_token will have a 1 hour expiry.</li>
  <li>The access token should be cached locally and included in each STAC API request as a bearer authorization header.</li>
  <li>When the access token has expired, an error 401 (Unauthorized) will be returned from STAC API requests.</li>
</ul>

<h2 id="examples">Examples</h2>

<h2 id="command-line">Command Line</h2>
<p>Example curl request to generate token</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl --location '&lt;ACCESS_TOKEN_URL HERE&gt;'  
--header 'Content-Type: application/x-www-form-urlencoded' \
--data-urlencode 'client_id=&lt;CLIENT_ID HERE&gt;' \ 
--data-urlencode 'client_secret=&lt;CLIENT SECRET HERE&gt;' \
--data-urlencode 'grant_type=client_credentials'
</code></pre></div></div>

<p>Example curl response</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{"access_token":"eyJraWQiO.......","expires_in":3600,"token_type":"Bearer"}
</code></pre></div></div>

<h2 id="python">Python</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
import json
import os
import requests

def _get_token(config=None):
    """Get token for interacting with the Earth Data Store API.

    By default, Earth Data Store will look for environment variables called
    EDS_AUTH_URL, EDS_SECRET and EDS_CLIENT_ID.

    Parameters
    ----------
    config : str | dict, optional
        A JSON string or a dictionary with the credentials for the Earth Data Store.
    presign_urls : bool, optional
        Use presigned URLs, by default True

    Returns
    -------
    token : str
    
    """
    if config is None:
        config = os.getenv
    auth_url = config("EDS_AUTH_URL")
    secret = config("EDS_SECRET")
    client_id = config("EDS_CLIENT_ID")
    
    if auth_url is None or secret is None or client_id is None:
        raise AttributeError(
            "You need to have env : EDS_AUTH_URL, EDS_SECRET and EDS_CLIENT_ID"
        )

    token_response = requests.post(
        auth_url,
        data={"grant_type": "client_credentials"},
        allow_redirects=False,
        auth=(client_id, secret),
    )
    token_response.raise_for_status()
    return json.loads(token_response.text)["access_token"]

print(_get_token())
}
</code></pre></div></div>

<h2 id="postman">Postman</h2>

<p>Below is the screenshot showing the <strong>Authorization tab</strong> in Postman and follow the steps</p>

<ol>
  <li>Select the Type as <span style="color: blue">OAuth 2.0</span></li>
  <li>Select the Grant Type as <span style="color: blue">Client Credentials</span></li>
  <li>Enter the access token URL from the account information page above :point_up_2:</li>
  <li>Enter the Client ID from the account information page above :point_up_2:</li>
  <li>Enter the Client Secret from the account information page above :point_up_2:</li>
</ol>

<p><img src="/Images/STACAPI/PostmanConfiguration.png" alt="Postman" /></p>
